<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Bert&#39;s Blog</title>
  <meta name="author" content="Bert Chang aka lazywei">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Bert&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Bert&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Bert&#39;s Blog</a></h1>
  <h2 class="subtitle">Hello, World!</h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/about">About</a></li>
    


    
    <li>
      <a href="https://github.com/lazywei" target="_blank"><i class="fa fa-github-alt fa-2x"></i></a>
    </li>
    
    
    
    <li>
      <a href="https://twitter.com/jrweizhang" target="_blank"><i class="fa fa-twitter fa-2x"></i></a>
    </li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-02-23T04:24:29.000Z"><a href="/2014/02/23/godir-with-direnv-for-golang-projects/">Feb 23 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/02/23/godir-with-direnv-for-golang-projects/">Godir with direnv for golang projects</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Last time, I described how I use <code>direnv</code> to manage my multiple golang projects (<a href="http://blog.lazywei.com/2014/02/10/use-direnv-to-manage-your-golang-projects/">link</a>). It&#39;s convenient to me, but repeating the steps everytime is somehow annoying.</p>
<p>Therefore, I&#39;d like to show my script to do those steps automatically today.
I puts the shell script <a href="https://github.com/lazywei/dotfiles/blob/master/bin/godir" target="_blank">here</a>.
You can download it into your <code>~/bin</code> and then add your <code>~/bin</code> to your <code>$PATH</code>.</p>
<p>Usage:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>godir project_name
</pre></td></tr></table></figure>

<p>What the script does are the following things:</p>
<ul>
<li>create a folder named <code>project_name</code></li>
<li>add direnv settings</li>
<li>create src folder</li>
</ul>
<p>There are, however, other problems need to deal with.</p>
<p>First, you should create a special project (e.g. <code>tools</code>), and add it to your <code>$PATH</code>. Then you can put general tools like <a href="https://github.com/nsf/gocode" target="_blank">gocode</a>, <a href="https://github.com/dinedal/textql" target="_blank">textql</a> into this folder.</p>
<p>Second, some useful packages like <a href="https://github.com/davecgh/go-spew" target="_blank">go-spew</a> should be installed in every projects. I think I will write some code to do it automatically next time.</p>
<p>Third, the <code>src</code> folder (<code>$PWD/src/github.com/lazywei</code>) is fixed now. I will make it more convenient for other to use. But for now, you should change it manually.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-02-10T03:32:00.000Z"><a href="/2014/02/10/use-direnv-to-manage-your-golang-projects/">Feb 10 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/02/10/use-direnv-to-manage-your-golang-projects/">Use direnv to manage your golang projects</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I used to put all my golang projects in to a directory so I only needed a single <code>GOPATH</code> and <code>PATH</code> configuration in my <code>.zshrc</code>.
However, this makes things complicated. There are too many projects in <code>GOPATH/src</code>, and it&#39;s hard to manage them.</p>
<p>Fortunately, I found <a href="https://github.com/zimbatm/direnv" target="_blank">direnv</a>. For more detail, please read its README. I&#39;m going to show how I use direnv to help me organize my golang projects.</p>
<ol>
<li>Install direnv</li>
<li><code>mkdir ~/GoProjects</code> and <code>cd ~/GoProjects</code></li>
<li><code>mkdir demo_project</code> and <code>cd demo_project</code></li>
<li><code>direnv edit .</code></li>
<li><p>Now direnv will open <code>.envrc</code> in your <code>$EDITOR</code>. We can then put</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="keyword">export</span> GOPATH=<span class="variable">$PWD</span>
<span class="keyword">export</span> PATH=<span class="variable">$PWD</span>/bin:<span class="variable">$PATH</span>
</pre></td></tr></table></figure>

<p>into this files.</p>
</li>
<li><code>go get ...</code></li>
</ol>
<p>Now <code>~/GoProjects/demo_project</code> is an independent workspace, enjoy it. Repeat the above steps to organize your projects.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-01-27T07:33:40.000Z"><a href="/2014/01/27/monit-and-golang-web-server/">Jan 27 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/27/monit-and-golang-web-server/">Monit and golang web server</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I wrote a golang web server, and I want to use monit to monitor it. If you haven&#39;t heard monit yet, you can check it out here: <a href="http://mmonit.com/monit/" target="_blank">Monit</a>.</p>
<p>The main problem is that my golang web server is not daemonable. So, the first step is to write a wrapper for monit.</p>
<h2 id="wrapper-for-monit">Wrapper for monit</h2>
<p>Suppose we use <code>go build -o ./my_server</code> to build our server, then we will have a executable binary at <code>./my_server</code>.</p>
<p>In the wrapper, we should echo PID to a file so monit can use the PID to monitor the process.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="shebang">#!/bin/bash
</span>
<span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span>
  start)
    <span class="built_in">cd</span> /home/deploy/<span class="built_in">source</span>/current;
    <span class="built_in">echo</span> $$ &gt; /home/deploy/<span class="built_in">source</span>/shared/pids/my_server.pid;
    <span class="keyword">exec</span> /home/deploy/<span class="built_in">source</span>/current/my_server &gt; /tmp/my_server.out <span class="number">2</span>&gt;&<span class="number">1</span>;
    ;;
  stop)
    kill `cat /home/deploy/<span class="built_in">source</span>/shared/pids/my_server.pid`;;
  *)
  <span class="built_in">echo</span> <span class="string">"usage: knife-knife-server-daemon {start|stop}"</span> ;;
<span class="keyword">esac</span>
<span class="keyword">exit</span> <span class="number">0</span>
</pre></td></tr></table></figure>

<p>The reason I use <code>/home/deploy/source/current/my_server &gt; /tmp/my_server.out 2&gt;&amp;1</code> is because I want to redirect the output of <code>my_server</code> to <code>/tmp/my_server.out</code> so that I can use it to debug.</p>
<h2 id="make-sure-your-wrapper-work">Make sure your wrapper work</h2>
<p>After creating the wrapper, you should be able to use <code>your_wrapper.sh start</code> to run your process. Then press <code>ctrl</code> + <code>z</code> to pause the program and get back to the shell. Secondly, use <code>bg</code> to run it in background. Now you can use <code>ps aux | grep my_server</code> and <code>cat /home/deploy/source/shared/pids/my_server.pid</code> to check there is nothing weird.</p>
<h2 id="monit-configuration">Monit configuration</h2>
<p>This step is relatively simple.</p>
<p>The configuration file should locate at <code>/etc/monit/conf.d/my_server.monitrc</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>check process my_server <span class="keyword">with</span> pidfile /home/deploy/source/<span class="keyword">shared</span>/pids/my_server.pid
  start = <span class="string">"/home/deploy/source/current/my_wrapper.sh start"</span>
  <span class="keyword">stop</span> = <span class="string">"/home/deploy/source/current/my_wrapper.sh stop"</span>
</pre></td></tr></table></figure>

<h2 id="finale">Finale</h2>
<p>Simply use <code>monit reload</code>, <code>monit start my_server</code> and <code>monit summary</code> to make sure everything is all right.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>I spent a lot of time on fix a weird bug. I can use wrapper to run the process. However, when I use <code>monit start my_server</code> the process can&#39;t be executed. It turns out the problem is I have:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>bufio<span class="preprocessor">.NewScanner</span>(os<span class="preprocessor">.Stdin</span>)
</pre></td></tr></table></figure>

<p>and the process will waiting the standard input. This will make monit wait for the process until timeout. After removing this line, everything works fine.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-01-08T14:10:55.000Z"><a href="/2014/01/08/install-scikit-learn-with-conda/">Jan 8 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/08/install-scikit-learn-with-conda/">Install scikit-learn with Conda</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="http://docs.continuum.io/conda/" target="_blank">Conda</a> is a powerful package manager tool for python, while <a href="http://scikit-learn.org/" target="_blank">scikit-learn</a> is a awesome machine learning libraries written in python.</p>
<ul>
<li>Download Conda: <a href="https://store.continuum.io/cshop/anaconda/" target="_blank">https://store.continuum.io/cshop/anaconda/</a></li>
</ul>
<p>After installing it, there will be a <code>anaconda</code> folder in your directory. You can choose add that directory into your <code>PATH</code>. I don&#39;t, however, because I don&#39;t want to override my brewed python.</p>
<p>Remember to update your conda:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>~<span class="regexp">/anaconda/bin</span><span class="regexp">/conda update conda</span>
</pre></td></tr></table></figure>

<ul>
<li>Create environment:</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="attribute">~/anaconda/bin/conda create -n py3k python</span>=<span class="string">3.3 anaconda</span>
</pre></td></tr></table></figure>

<p>You can, of course, use <code>conda</code> directly if you added <code>anaconda/bin</code> into your <code>PATH</code>.</p>
<ul>
<li>Activate the environment:</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="built_in">source</span> ~/anaconda/bin/activate py3k
</pre></td></tr></table></figure>

<ul>
<li>Install <code>scikit-learn</code>:</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>~<span class="regexp">/anaconda/bin</span><span class="regexp">/conda install scikit-learn</span>
</pre></td></tr></table></figure>

<p>I&#39;m confused with whether should I use this approach to install <code>scikit-learn</code> or not? Should I use <code>pip</code> instead?</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-12-17T12:45:52.000Z"><a href="/2013/12/17/go-bindings-for-opencv-go-opencv/">Dec 17 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/17/go-bindings-for-opencv-go-opencv/">Go bindings for OpenCV: go-opencv</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I would like to introduce a golang package: <a href="https://github.com/lazywei/go-opencv" target="_blank">go-opencv</a>.</p>
<p>The <a href="https://code.google.com/p/go-opencv" target="_blank">original project</a> is created by @chaishushan and is hosted on Google code. However, it seems that it has been abandoned. Therefore, I choose to fork this project and host it on Github. Furthermore, I think Github is more popular nowadays, and it&#39;s easier to fork/contribute on github than on Google code.</p>
<h2 id="introduction">Introduction</h2>
<p><strong><a href="https://github.com/lazywei/go-opencv" target="_blank">go-opencv</a></strong> is a Golang binding for <a href="http://opencv.org/" target="_blank">OpenCV</a>, which is used for computer vision.</p>
<h2 id="requirement">Requirement</h2>
<p>Before using <a href="https://github.com/lazywei/go-opencv" target="_blank">go-opencv</a>, you should install OpenCV first. On Mac OS X, you can use homebrew:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>brew <span class="keyword">install</span> opencv
</pre></td></tr></table></figure>

<p>On Ubuntu,</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>sudo apt<span class="attribute">-get</span> install libopencv<span class="attribute">-dev</span>
</pre></td></tr></table></figure>

<h2 id="installation">Installation</h2>
<p>Please use <code>go get -u</code> to get the latest version of <a href="https://github.com/lazywei/go-opencv" target="_blank">go-opencv</a>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>go get <span class="attribute">-u</span> github<span class="built_in">.</span>com/lazywei/go<span class="attribute">-opencv</span>
</pre></td></tr></table></figure>

<h2 id="simple-usage">Simple Usage</h2>
<p>Here is a simple image resizing example for <a href="https://github.com/lazywei/go-opencv" target="_blank">go-opencv</a>:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="keyword">package</span> main

<span class="keyword">import</span> opencv <span class="string">"github.com/lazywei/go-opencv/opencv"</span>

<span class="keyword">func</span> main() {
	filename := <span class="string">"bert.jpg"</span>
	srcImg := opencv.LoadImage(filename)
	<span class="keyword">if</span> srcImg == <span class="constant">nil</span> {
		<span class="built_in">panic</span>(<span class="string">"Loading Image failed"</span>)
	}
	<span class="keyword">defer</span> srcImg.Release()
	resized1 := opencv.Resize(srcImg,<span class="number"> 400</span>,<span class="number"> 0</span>,<span class="number"> 0</span>)
	resized2 := opencv.Resize(srcImg,<span class="number"> 300</span>,<span class="number"> 500</span>,<span class="number"> 0</span>)
	resized3 := opencv.Resize(srcImg,<span class="number"> 300</span>,<span class="number"> 500</span>,<span class="number"> 2</span>)
	opencv.SaveImage(<span class="string">"resized1.jpg"</span>, resized1,<span class="number"> 0</span>)
	opencv.SaveImage(<span class="string">"resized2.jpg"</span>, resized2,<span class="number"> 0</span>)
	opencv.SaveImage(<span class="string">"resized3.jpg"</span>, resized3,<span class="number"> 0</span>)
}
</pre></td></tr></table></figure>

<p>You can find more samples on: <a href="https://github.com/lazywei/go-opencv/tree/master/samples" target="_blank">https://github.com/lazywei/go-opencv/tree/master/samples</a></p>
<h2 id="contributing">Contributing</h2>
<p>The most important reason I fork and host this project on Github is that I want to make it simple for others to help maintain/develop this project. Therefore, please feel free to open a pull request anytime you want to commit your change. Also, I need some help to make the API document more detail. Please let me know if there is any concern, you can ping me on Github(@lazywei) or on Twitter(@jrweizhang).</p>
<p>Thanks!</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-12-07T08:37:25.000Z"><a href="/2013/12/07/getting-started-with-camlistore-0/">Dec 7 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/07/getting-started-with-camlistore-0/">Getting started with Camlistore (0)</a></h1>
  

    </header>
    <div class="entry">
      
        <blockquote>
<p>Camlistore is your personal storage system for life.</p>
</blockquote>
<p>If you have never heard about <a href="http://camlistore.org/" target="_blank">Camlistore</a> before, you can checkout the video demo on the website.</p>
<p>I would like to write down the process of setting up a Camlistore server and how to using it and help more people know how wonderful and useful Camlistore is.</p>
<h2 id="install-go">Install GO</h2>
<p>If you haven&#39;t had GO installed, you can use <a href="https://github.com/moovweb/gvm" target="_blank">gvm</a> to install it.
Please read the requirement section of its <a href="https://github.com/moovweb/gvm#mac-os-x-requirements" target="_blank">README</a>, and then</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>bash &lt; &lt;(curl -s <span class="symbol">https:</span>/<span class="regexp">/raw.github.com/moovweb</span><span class="regexp">/gvm/master</span><span class="regexp">/binscripts/gvm</span>-installer)
gvm install go1.<span class="number">2</span>
gvm use go1.<span class="number">2</span>
</pre></td></tr></table></figure>

<h2 id="build-camlistore">Build Camlistore</h2>
<p>After installing GO, it&#39;s time to build Camlistore. First, download zip from <a href="http://camlistore.org/download" target="_blank">http://camlistore.org/download</a> or use git clone just like me:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>git <span class="keyword">clone</span> https:<span class="comment">//github.com/bradfitz/camlistore</span>
</pre></td></tr></table></figure>

<p>Install:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>cd camlistore
<span class="keyword">go</span> run <span class="built_in">make</span>.<span class="keyword">go</span>
</pre></td></tr></table></figure>

<p>If you use <code>homebrew</code> as your package management on OS X, you may get error when building <code>go-sqlite3</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>camlistore.org/third_party/github.com/mattn/go-sqlite3
# pkg-config <span class="comment">--cflags sqlite3</span>
<span class="keyword">Package</span> sqlite3 was <span class="keyword">not</span> found <span class="keyword">in</span> the pkg-config search path.
Perhaps you should add the directory containing `sqlite3.pc'
<span class="keyword">to</span> the PKG_CONFIG_PATH environment <span class="keyword">variable</span>
No <span class="keyword">package</span> <span class="attribute">'sqlite3</span>' found
<span class="keyword">exit</span> status <span class="number">1</span>
</pre></td></tr></table></figure>

<p>The solution is use this command instead:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="constant">PKG_CONFIG_PATH</span>=<span class="regexp">/usr/local</span><span class="regexp">/Cellar/sqlite</span><span class="regexp">/*/lib</span><span class="regexp">/pkgconfig/</span> go run make.go
</pre></td></tr></table></figure>

<p>You can find more detail on <a href="https://github.com/mattn/go-sqlite3/issues/45" target="_blank">https://github.com/mattn/go-sqlite3/issues/45</a>.</p>
<h2 id="run-and-initialize-camlistore">Run and initialize Camlistore</h2>
<p>Now you can start the camlistore server by</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>./bin/camlistored
</pre></td></tr></table></figure>

<p>It will then generate server configuration file, at <code>$HOME/.config/camlistore/server-config.json</code>, and a new secret keyring: <code>$HOME/.config/camlistore/identify-secring.gpg</code>.
You should then see the following message after starting the camlistore server:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>Generated <span class="keyword">new</span> identity <span class="keyword">with</span> keyId <span class="string">"1427D50D"</span>
</pre></td></tr></table></figure>

<p>Use this key to initialize client command tools:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="string">.</span><span class="comment">/bin/camput</span> <span class="comment">init</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">gpgkey</span> <span class="comment">1427D50D</span>
</pre></td></tr></table></figure>

<p>The client configuration file is located at</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$HOME/<span class="preprocessor">.config</span>/camlistore/client-config<span class="preprocessor">.json</span>
</pre></td></tr></table></figure>

<p>I will write about the basic usage in next post in this series.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-12-05T02:18:17.000Z"><a href="/2013/12/05/iloveck101---parallel-downloading-beauties/">Dec 5 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/05/iloveck101---parallel-downloading-beauties/">iloveck101 - parallel downloading beauties</a></h1>
  

    </header>
    <div class="entry">
      
        <p>@tzangms wrote an amazing python script few days ago, <a href="https://github.com/tzangms/iloveck101" target="_blank">iloveck101</a>. It is a tool for downloading all the images in the post of CK101 卡提諾論壇 (e.g. <a href="http://ck101.com/thread-2864249-1-1.html" target="_blank">http://ck101.com/thread-2864249-1-1.html</a>). Then we don&#39;t need to wait for the lazy image loading and those annoying ads.</p>
<p>As soon as @tzangms release this cool tool, there are many others clone in other languages show up. For example, there is a node.js version: <a href="https://github.com/clonn/iloveck101" target="_blank">https://github.com/clonn/iloveck101</a>.</p>
<p>I also rewrite it in golang: <a href="https://github.com/lazywei/iloveck101" target="_blank">https://github.com/lazywei/iloveck101</a>. Thanks goroutine, this version allows you to download images parallely.</p>
<h3 id="install">Install</h3>
<p><code>go get github.com/lazywei/iloveck101</code></p>
<h3 id="usage">Usage</h3>
<p><code>iloveck101 -u [url] -w [workers number]</code></p>
<h3 id="example">Example</h3>
<p><code>iloveck101 -u http://ck101.com/thread-2864249-1-1.html -w 50</code></p>
<p>Then it will create a folder in <code>~/Pictures/iloveck101</code> which contains all the beauties&#39; images :)</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-12-02T15:04:27.000Z"><a href="/2013/12/02/zsh-and-tmux-path/">Dec 2 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/02/zsh-and-tmux-path/">Zsh and Tmux path</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I got some weird PATH problems since I started using Tmux. I noticed that the PATH with tmux isn&#39;t the same as without tmux. It seems that there are duplicated some paths.</p>
<p>I use rbenv as my ruby version manager, and the duplicated path broke it. The <code>ruby</code> command will execute system ruby instead of rbenv&#39;s.</p>
<p>I then found the problem is my <code>zshrc</code> extend PATH in this way:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="keyword">export</span> PATH=/usr/local/bin:<span class="variable">$PATH</span>
</pre></td></tr></table></figure>

<p>It means that the PATH will be appended some path to it everytime the <code>zshrc</code> be loaded.</p>
<p>Therefore, I hard code the path first in the <code>zshrc</code>, and then extend it:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>export PATH=<span class="regexp">/Users/</span>lazywei/.rbenv/shims:<span class="regexp">/Users/</span>lazywei/.rbenv/bin:<span class="regexp">/usr/</span>bin:<span class="regexp">/bin:/</span>usr/sbin:<span class="regexp">/sbin:/</span>usr/local/bin:<span class="regexp">/opt/</span>X11/bin:<span class="regexp">/usr/</span>local/go/bin:<span class="regexp">/usr/</span>texbin
export PATH=<span class="regexp">/usr/</span>local/bin:$PATH
</pre></td></tr></table></figure>

<p>Then the PATH will reset everytime the <code>zshrc</code> got loaded.</p>
<p>This workaround is dirty but is good enough for me.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-11-25T11:12:08.000Z"><a href="/2013/11/25/goconvey-and-gocheck/">Nov 25 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/25/goconvey-and-gocheck/">GoConvey and Gocheck</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I currently use <a href="http://smartystreets.github.io/goconvey/" target="_blank">GoConvey</a> and <a href="http://labix.org/gocheck" target="_blank">Gocheck</a> as my testing framework.</p>
<h2 id="goconvey">GoConvey</h2>
<p>GoConvey runs a HTTP server which has a really beautiful Web UI for reviewing testing results. The most important is that it will re-run the tests every time you change and save the files. In other words, it will watch any change of you files and run tests when need.</p>
<h2 id="gocheck">Gocheck</h2>
<p>Though GoConvey has a nice Web UI, it doesn&#39;t provide something like <code>SetupTest()</code>, which will be used to set common settings and will be called in every test case. Fortunately, there is a richer testing framework, Gocheck. Gocheck provides many useful features (e.g. fixtures, useful assertions and checks), and can be integrated with GoConvy.</p>
<h2 id="examples">Examples</h2>
<p>Here are some simple examples that how to use these two wonderful testing framework together. You should run <code>goconvey</code> in terminal and open <code>http://localhost:8080</code> first.</p>
<ul>
<li>Use GoConvey&#39;s <code>Convey</code> and Gocheck&#39;s <code>Suite</code>:</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="code"><pre><span class="keyword">import</span> (
	<span class="string">"testing"</span>
	<span class="string">"github.com/smartystreets/goconvey/convey"</span>
	. <span class="string">"launchpad.net/gocheck"</span>
)

<span class="comment">// Hook up gocheck into the "go test" runner.</span>
<span class="keyword">func</span> Test(t *testing.T) {
	TestingT(t)
}

<span class="keyword">var</span> _ = Suite(&S{})

<span class="keyword">type</span> S <span class="keyword">struct</span> {
	intShouldBeFive <span class="typename">int</span>
}

<span class="keyword">func</span> (self *S) SetUpTest(c *C) {
	intShouldBeFive =<span class="number"> 5</span>
}

<span class="keyword">func</span> (self *S) TestIntShouldBeFive(c *C) {
	convey.Convey(<span class="string">"Foo"</span>, c, <span class="keyword">func</span>() {
		convey.So<span class="number">(5</span>, convey.ShouldEqual, self.intShouldBeFive)
	})
}
</pre></td></tr></table></figure>

<ul>
<li>Use Gocheck&#39;s assertions, and use GoConvey&#39;s Web UI only:</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="code"><pre><span class="keyword">import</span> (
	<span class="string">"testing"</span>
	. <span class="string">"launchpad.net/gocheck"</span>
)

<span class="comment">// Hook up gocheck into the "go test" runner.</span>
<span class="keyword">func</span> Test(t *testing.T) {
	TestingT(t)
}

<span class="keyword">var</span> _ = Suite(&S{})

<span class="keyword">type</span> S <span class="keyword">struct</span> {
	intShouldBeFive <span class="typename">int</span>
}

<span class="keyword">func</span> (self *S) SetUpTest(c *C) {
	intShouldBeFive =<span class="number"> 5</span>
}

<span class="keyword">func</span> (self *S) TestIntShouldBeFive(c *C) {
	c.Check(self.intShouldBeFive, Equals,<span class="number"> 5</span>, Commentf(<span class="string">"Int should be five failed."</span>))
}
</pre></td></tr></table></figure>

<p>You can also find the real world examples at <a href="https://github.com/polydice/pulse" target="_blank">polydice/pulse</a>.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-11-24T12:38:14.000Z"><a href="/2013/11/24/vim-matlab/">Nov 24 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/24/vim-matlab/">Vim-matlab</a></h1>
  

    </header>
    <div class="entry">
      
        <p>TL;NR: Install the plug-in via github: <a href="https://github.com/lazywei/vim-matlab" target="_blank">Vim-Matlab</a>.</p>
<p>As I use vim daily for everything, I use it for writing Matlab code. However, the default behavior of Vim&#39;s Matlab support is not as well as I expected.</p>
<p>Fortunately, I found a <a href="http://www.mathworks.com/matlabcentral/fileexchange/21798-editing-matlab-files-in-vim" target="_blank">vim plug-in</a> to improve this. Though this plug-in works pretty well, it isn&#39;t in a version control system (e.g. git), which make it hard to maintain and even install. Therefore, I download it and host it on github, you can then install it through any method you like. Personally, I prefer <a href="https://github.com/gmarik/vundle" target="_blank">Vundle</a>.</p>
<p>Vim-Matlab: <a href="https://github.com/lazywei/vim-matlab" target="_blank">repo</a></p>
<p>Features:</p>
<ul>
<li>Syntax highlighting</li>
<li>Correct indentation</li>
<li>Correct setting to use the <code>matchit.vim</code> script</li>
<li>Tag support</li>
<li>Help file</li>
</ul>
<p>Again, I don&#39;t own these codes. I only copy it and host it on github. If there is any concern, please let me know. Thanks!</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:blog.lazywei.com">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">Recent Posts</h3>
  <ul class="entry">
    
      <li>
        <a href="/2014/02/23/godir-with-direnv-for-golang-projects/">Godir with direnv for golang projects</a>
      </li>
    
      <li>
        <a href="/2014/02/10/use-direnv-to-manage-your-golang-projects/">Use direnv to manage your golang projects</a>
      </li>
    
      <li>
        <a href="/2014/01/27/monit-and-golang-web-server/">Monit and golang web server</a>
      </li>
    
      <li>
        <a href="/2014/01/08/install-scikit-learn-with-conda/">Install scikit-learn with Conda</a>
      </li>
    
      <li>
        <a href="/2013/12/17/go-bindings-for-opencv-go-opencv/">Go bindings for OpenCV: go-opencv</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/Camlistore/">Camlistore</a><small>1</small></li>
  
    <li><a href="/tags/Golang/">Golang</a><small>5</small></li>
  
    <li><a href="/tags/Haskell/">Haskell</a><small>1</small></li>
  
    <li><a href="/tags/Hexo/">Hexo</a><small>1</small></li>
  
    <li><a href="/tags/Latex/">Latex</a><small>1</small></li>
  
    <li><a href="/tags/Linux/">Linux</a><small>1</small></li>
  
    <li><a href="/tags/Machine Learning/">Machine Learning</a><small>1</small></li>
  
    <li><a href="/tags/Matlab/">Matlab</a><small>1</small></li>
  
    <li><a href="/tags/Monit/">Monit</a><small>1</small></li>
  
    <li><a href="/tags/OpenCV/">OpenCV</a><small>1</small></li>
  
    <li><a href="/tags/Python/">Python</a><small>1</small></li>
  
    <li><a href="/tags/Testing/">Testing</a><small>1</small></li>
  
    <li><a href="/tags/Tmux/">Tmux</a><small>1</small></li>
  
    <li><a href="/tags/Vim/">Vim</a><small>2</small></li>
  
    <li><a href="/tags/Zsh/">Zsh</a><small>1</small></li>
  
    <li><a href="/tags/direnv/">direnv</a><small>2</small></li>
  
    <li><a href="/tags/golang/">golang</a><small>2</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 Bert Chang aka lazywei
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'bloglazywei';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
